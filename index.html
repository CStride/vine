<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VINE</title>
    <link rel="icon" href="./assets/icon-favicon.png"/>
    <link rel="stylesheet" type="text/css" href="./index.css"/>
    <link rel="stylesheet" type="text/css" href="./style/main.css"/>
</head>
<body>
    <div id="layout">
        <div id="top"></div>
        <div id="center">
            <span id="title">VINE</span>
            <div id="search-box">
                <div id="search-engine"></div>
                <input id="input-box" type="text" placeholder="Search or type a URL"/>
                <img id="icon-searching" class="icon" src="./assets/searching.png"/>
            </div>
            <div id="QLink-List"></div>
        </div>
    </div>
    <div id="addshortcut-dialog">
        <span>Add shortcut</span>
        <div id="dialogItem-container">
            <div class="dialog-item">
                <span>Name</span>
                <input id="dialogInput-name" type="text"/>
            </div>
            <div class="dialog-item">
                <span>URL</span>
                <input id="dialogInput-url" type="text"/>
            </div>
        </div>
        <div id="dialogButton-container">
            <button id="dialog-done">Done</button>
            <button id="dialog-cancle">Cancle</button>
        </div>
    </div>
    <div id="overlay"></div>
    <script type="module">
        import { ADDSHORTCUT} from "./components/QLinkFunc.js"
        import { initializeData } from "./data/initData.js"

        // initialize dom
        const node_QLinkList = document.querySelector("#QLink-List");
        node_QLinkList.appendChild(ADDSHORTCUT);

        ADDSHORTCUT.addEventListener("click", openAddShortcutDialog);

        // initialize data
        initializeData();


        // set listeners
        const node_dialogcancle = document.querySelector("#dialog-cancle");
        const node_overlay = document.querySelector("#overlay");
        node_dialogcancle.addEventListener("click", closeAddShortcutDialog);
        node_overlay.addEventListener("click", closeAddShortcutDialog);

        const node_dialogdone = document.querySelector("#dialog-done");
        node_dialogdone.addEventListener("click", addShortcut);

        const nodes_menuItem = document.getElementsByClassName("menuItem");
        const menuItems = Array.from(nodes_menuItem);
        menuItems.forEach((menuItem) => {
            menuItem.addEventListener("mouseover", (event) => {
                event.stopPropagation();
            });
            menuItem.addEventListener("mouseenter", (event) => {
                event.stopPropagation();
                menuItem.style.backgroundColor = "#2E94B9";
                console.log("menuItem");
            });
            menuItem.addEventListener("mouseleave", (event) => {
                event.stopPropagation();
                menuItem.style.backgroundColor = "white";
            })

            menuItem.addEventListener("click", (event) => {
                event.preventDefault();
            });
        });

        const nodes_menuContainer = document.getElementsByClassName("menuContainer");
        const menuContainers = Array.from(nodes_menuContainer);
        menuContainers.forEach((menuContainer) => {
            menuContainer.addEventListener("click", (event) => {
                event.preventDefault();
            });
        })

        const nodes_QLink = document.getElementsByClassName("QLink");
        const QLinks = Array.from(nodes_QLink);
        QLinks.forEach((QLink) => {
            QLink.addEventListener("mouseenter", (event) => {
                QLink.style.backgroundColor = "#f2f4f6";
                console.log("QLink");
            });
            QLink.addEventListener("mouseleave", (event) => {
                QLink.style.backgroundColor = "white";
            });
        })
        // ADDSHORTCUT.addEventListener("blur", closeAddShortcutDialog);


        // functions
        function openAddShortcutDialog() {
            const dialog = document.getElementById("addshortcut-dialog");
            const overlay = document.getElementById("overlay");

            dialog.style.display = "block";
            overlay.style.display = "block";
        }

        function closeAddShortcutDialog() {
            const dialog = document.getElementById("addshortcut-dialog");
            const overlay = document.getElementById("overlay");

            const input_name = document.getElementById("dialogInput-name");
            const input_url = document.getElementById("dialogInput-url");
            input_name.value = "";
            input_url.value = "";

            dialog.style.display = "none";
            overlay.style.display = "none";
        }

        function addShortcut() {
            const input_name = document.getElementById("dialogInput-name");
            const input_url = document.getElementById("dialogInput-url");

            const name = input_name.value;
            const url = input_url.value;

            console.log(name, url);
            closeAddShortcutDialog();
        }
    </script>
</body>
</html>